---
description: 强制执行 TDD 工作流，确保 80%+ 测试覆盖率
agent: tdd-guide
subtask: true
---

# TDD 命令

使用严格的测试驱动开发来实现：$ARGUMENTS

## TDD 循环（必须）

```
RED → GREEN → REFACTOR → REPEAT
```

1. **RED**：先编写一个失败的测试
2. **GREEN**：编写最少代码使测试通过
3. **REFACTOR**：在保持测试通过的同时重构代码
4. **REPEAT**：继续直到功能完成

## 你的任务

### 步骤 1：定义接口（脚手架）

- 定义输入/输出的 TypeScript 接口
- 创建函数签名，使用 `throw new Error('Not implemented')`

### 步骤 2：编写失败的测试（RED）

- 编写测试来验证接口
- 包括正常路径、边界情况和错误条件
- 运行测试 - 确认它们失败

### 步骤 3：实现最小代码（GREEN）

- 编写刚好足够的代码使测试通过
- 不要过早优化
- 运行测试 - 确认它们通过

### 步骤 4：重构（改进）

- 提取常量，改进命名
- 删除重复代码
- 运行测试 - 确认它们仍然通过

### 步骤 5：检查覆盖率

- 目标：最低 80%
- 核心业务逻辑 100%
- 如需要，添加更多测试

## 覆盖率要求

| 代码类型     | 最低要求 |
| ------------ | -------- |
| 标准代码     | 80%      |
| 金融计算     | 100%     |
| 认证逻辑     | 100%     |
| 安全关键代码 | 100%     |

## 需要包含的测试类型

- **单元测试**：单个函数
- **边界情况**：空值、null、最大值、边界值
- **错误条件**：无效输入、网络故障
- **集成测试**：API 端点、数据库操作

---

**必须**：必须在实现之前编写测试。永远不要跳过 RED 阶段。
